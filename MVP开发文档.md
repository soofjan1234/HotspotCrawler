# 热点爬虫系统 - MVP开发文档

## 1. MVP概述

### 1.1 MVP目标
MVP（最小可行产品）阶段的核心目标是快速实现系统的核心功能，验证业务价值并获取用户反馈，为后续迭代开发提供依据。

### 1.2 MVP范围界定
在MVP阶段，我们将优先实现以下核心功能，确保系统能够完成基本的热点内容爬取、存储和展示流程：

- 从今日头条爬取热点内容
- 基本的数据存储功能
- 简易的HTML操作界面
- 基础的日志记录功能

## 2. 开发优先级与阶段规划

### 2.1 功能优先级矩阵

| 功能模块 | 优先级 | 开发阶段 | 验收标准 |
|---------|--------|---------|----------|
| 基础爬虫框架 | P0 | 第一阶段 | 成功爬取单个平台今日头条内容 |
| 简易HTML界面 | P0 | 第一阶段 | 界面可正常访问，按钮可点击触发操作 |
| 基础存储功能 | P1 | 第二阶段 | 成功存储爬取内容到指定目录 |
| 日志记录功能 | P1 | 第二阶段 | 日志显示操作状态和存储路径信息 |
| 定时任务功能 | P2 | 第三阶段 | 系统可按设定时间自动运行 |
| AI文案生成功能 | P2 | 后续迭代 | 生成基础文案内容 |

## 3. 技术架构设计

### 3.1 技术选型

| 技术/框架 | 用途 | 选型理由 |
|----------|------|----------|
| Python 3.x | 核心开发语言 | 丰富的爬虫库支持，生态成熟 |
| Beautiful Soup / Scrapy | 网页解析 | 强大的HTML解析能力，适合内容提取 |
| Flask | Web框架 | 轻量级，适合快速开发简易界面 |
| SQLite | 临时数据存储 | 轻量级，无需额外数据库服务 |
| APScheduler | 定时任务 | 简单易用，适合Python环境 |

## 4. 当前开发进度

### 4.1 已完成模块

- **基础爬虫框架**：已实现从今日头条爬取热点内容功能，支持多个频道（今日要闻、城市相关、财经、科技、热点）的文章抓取
- **基础存储功能**：已实现文章内容、图片和视频的存储功能，自动创建目录结构和文件保存
- **基础日志记录功能**：已实现操作状态和存储路径信息的日志输出
- **提取功能优化**： 现在是重复则不提取，要改为重复则下一个
- **随机提取**：一次提取，随机提取十篇文章，找一个合适的随机算法，避免总是提取某一频道的。
- **定时任务功能**

### 4.2 待完成模块

- **简易HTML操作界面**: 运行、日志查看、ai提取
- **AI文案生成功能**：尚未实现

### 4.3 优化部分

- **滚动提取**：当现有页面的文章都被提取完了，自动滚动加载更多文章，继续提取。
- **重试机制**：在网络问题导致爬取失败时实现自动重试
- **数量限制**： 图片是否限制10张
- **显示问题**：切换页面就会刷新日志

---

本MVP开发文档专注于快速实现核心功能，验证业务价值。在MVP完成后，将根据实际使用情况和用户反馈进行调整和扩展。

# AI文案生成功能实现规划
## 前端实现
1. 添加UI元素 ：在现有界面的按钮组中添加"生成AI文案"按钮
2. 文件选择功能 ：实现文件选择器，允许用户从media文件夹中选择.txt文件
3. 跳转新Dialog，结果展示 ：显示生成结果和操作反馈
4. 交互逻辑 ：
   - 点击按钮触发文件选择
   - 选择文件后发送请求到后端API
   - 显示生成状态和结果

## 后端实现
1. 新增模块 ：创建 ai_generator.py 工具模块，封装AI生成相关功能
2. DeepSeek API集成 ：
   - 实现API调用函数，处理认证和请求格式
   - 添加重试机制和错误处理
3. 文件处理 ：
   - 实现从media目录读取.txt文件内容的函数
   - 实现将生成的新文案写回原文件或创建新文件的功能
4. 新增API端点 ：
   - 创建 /generate-ai-content 路由，接收文件路径参数
   - 处理请求，调用AI生成功能，返回结果
5. 配置管理 ：
   - 在config.yml中添加DeepSeek API密钥配置（安全存储）
   - 添加AI生成相关参数配置（如生成长度、温度等）
6. 日志记录 ：记录AI生成过程的关键信息和错误